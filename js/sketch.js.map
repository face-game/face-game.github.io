{"version":3,"sources":["js/sketch.js"],"names":["sketch","s","videoInput","poseNet","canvasBg","player","getContent","callback","request","XMLHttpRequest","open","onload","getContentOnload","status","lines","responseText","split","content","int","random","length","debug","console","log","onerror","getContentOnerror","err","send","wakeupRemote","wakeupOnload","data","JSON","parse","remoteAwake","wakeupOnerror","init","cameraReady","modelReady","ended","loc","coords","poses","part","level","snapped","sent","i","levels","img","loaded","loadImage","src","cursor","counter","obj","side","dist","size","setup","createCanvas","textSize","createCapture","video","width","min","ideal","max","height","audio","hide","ml5","on","results","draw","imageMode","CORNERS","background","color","push","translate","scale","image","get","pop","textFont","navigator","userAgent","toLowerCase","search","textAlign","CENTER","text","match","currLevel","score","noseScore","pose","keypoints","find","key","position","x","y","fill","noStroke","LEFT","TOP","RIGHT","BOTTOM","distFrom","Math","hypot","CORNER","stroke","sendData","images","created","Date","window","devicePixelRatio","canvas","toDataURL","setRequestHeader","stringify","mousePressed","keyPressed","keyCode","p5Runtime","p5"],"mappings":"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","sourcesContent":["/* public/js/sketch.js\n * Originally created 9/29/2017 by Perry Naseck (DaAwesomeP)\n * https://github.com/face-game/face-game\n *\n * Copyright 2018-present Perry Naseck (DaAwesomeP)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* global p5, ml5, XMLHttpRequest */\n/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"p5Runtime| }] */\n/* eslint new-cap: [\"error\", { \"newIsCapExceptionPattern\": \"clm|p5\" }] */\n'use strict'\n\nvar sketch = function (s) {\n  var videoInput\n  var poseNet\n  var canvasBg\n\n  var player = {}\n  var getContent = function getContent (callback) {\n    let request = new XMLHttpRequest()\n    request.open('GET', 'https://face-game.github.io/face-game-content/content.txt', true)\n    request.onload = function getContentOnload () {\n      if (request.status >= 200 && request.status < 400) {\n        let lines = request.responseText.split('\\n')\n        player.content = lines[s.int(s.random(lines.length - 1))]\n        if (player.debug) console.log('content', player.content)\n        callback()\n      }\n    }\n    request.onerror = function getContentOnerror (err) {\n      console.log('getContentError', err)\n      player.content = false\n    }\n    request.send()\n  }\n  var wakeupRemote = function wakeupRemote () {\n    let request = new XMLHttpRequest()\n    request.open('GET', 'https://face-game.glitch.me/api/0/wakeup', true)\n    request.onload = function wakeupOnload () {\n      if (request.status >= 200 && request.status < 400) {\n        let data = JSON.parse(request.responseText)\n        if (data === { status: 200 }) player.remoteAwake = true\n        else player.remoteAwake = false\n        if (player.debug) console.log('wakeupRemote', data)\n      }\n    }\n    request.onerror = function wakeupOnerror (err) {\n      console.log('wakeupError', err)\n      player.remoteAwake = false\n    }\n    request.send()\n  }\n  var init = function init (cameraReady = false, modelReady = false, debug = false, callback) {\n    if (player.debug) console.log('init')\n    player = {\n      ended: false,\n      loc: false,\n      coords: false,\n      cameraReady: cameraReady,\n      modelReady: modelReady,\n      poses: [],\n      part: {},\n      level: 1,\n      snapped: [],\n      sent: false,\n      remoteAwake: false,\n      content: false,\n      debug: debug\n    }\n    wakeupRemote()\n    getContent(() => {\n      for (let i in levels) {\n        levels[i].img.loaded = s.loadImage(levels[i].img.src)\n        levels[i].cursor.loaded = s.loadImage(levels[i].cursor.src)\n        levels[i].img.counter = s.loadImage(`https://face-game.github.io/face-game-content/level-${s.int(i) + 1}/${player.content}.png`)\n      }\n      callback()\n    })\n  }\n  var levels = [\n    {\n      obj: 'Stick out your tongue, turn your head, and lick the lollipop',\n      loc: [65, 185],\n      side: 0,\n      dist: 40,\n      img: {\n        src: '/img/level-01.png',\n        size: [100, 100]\n      },\n      cursor: {\n        src: '/img/cursor-01.png',\n        size: [100, 100]\n      }\n    },\n    {\n      obj: 'Pucker your lips, turn your head, and kiss the puppy',\n      loc: [575, 260],\n      side: 1,\n      dist: 40,\n      img: {\n        src: '/img/level-02.png',\n        size: [100, 100]\n      },\n      cursor: {\n        src: '/img/cursor-02.png',\n        size: [100, 100]\n      }\n    }\n  ]\n\n  s.setup = function setup () {\n    init(false, false, false, () => {\n      canvasBg = s.loadImage('/img/45-degree-fabric-light.png')\n      s.createCanvas(640, 480)\n      s.textSize(50)\n\n      videoInput = s.createCapture({\n        video: {\n          width: { min: 320, ideal: 640, max: 640 },\n          height: { min: 240, ideal: 480, max: 480 }\n        },\n        audio: false\n      }, () => {\n        player.cameraReady = true\n      })\n      // videoInput.size(640, 480)\n      videoInput.hide()\n\n      poseNet = ml5.poseNet(videoInput, () => {\n        player.modelReady = true\n      })\n      poseNet.on('pose', (results) => {\n        player.poses = results\n      })\n    })\n  }\n\n  s.draw = function draw () {\n    s.imageMode(s.CORNERS)\n    s.background(s.color(252, 249, 213))\n    if (player.debug) {\n      s.push()\n      s.translate(s.width, 0)\n      s.scale(-1.0, 1.0)\n      s.image(videoInput.get(), 0, 0, s.width, s.height)\n      s.pop()\n    }\n    // s.background(canvasBg)\n    s.textFont('Gloria Hallelujah', 22)\n    if (navigator.userAgent.toLowerCase().search('phone') !== -1 ||\n        navigator.userAgent.toLowerCase().search('ipad') !== -1 ||\n        navigator.userAgent.toLowerCase().search('android') !== -1) {\n      s.textAlign(s.CENTER, s.CENTER)\n      s.text('Sorry, but the game only works on desktop or laptop computers! The game doesn\\'t run well on phones and tablets.', s.width / 4, s.height / 4, s.width / 2, s.height / 2)\n    } else if (navigator.userAgent.match(/(Version)\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari/g) ||\n               navigator.userAgent.match(/(Edge)\\/(\\d+)(?:\\.(\\d+))?/g) ||\n               navigator.userAgent.match(/(MSIE) (\\d+)(?:\\.(\\d+))?/g) ||\n               navigator.userAgent.match(/(Trident)\\/(\\d+)(?:\\.(\\d+))?/g)) {\n      // Safari match regex adjusted from\n      // https://jonlabelle.com/snippets/view/yaml/browser-user-agent-regular-expressions\n      s.textAlign(s.CENTER, s.CENTER)\n      s.text('Sorry, but the game doesn\\'t work in Safari, Edge, or Internet Explorer! The game uses technology for face detection with cameras in the browser. Please try Mozilla Firefox, Google Chrome, or Opera.', s.width / 4, s.height / 4, s.width / 2, s.height / 2)\n    } else if (!player.cameraReady) {\n      if (player.debug) console.log('not camera ready')\n      s.textAlign(s.CENTER, s.CENTER)\n      s.text('Your browser will prompt you to allow this website to access your camera. Please allow access to play the game.', s.width / 4, s.height / 4, s.width / 2, s.height / 2)\n    } else if (!player.modelReady) {\n      if (player.debug) console.log('show loading')\n      s.textAlign(s.CENTER, s.CENTER)\n      s.text('Loading face detection model...', s.width / 4, s.height / 4, s.width / 2, s.height / 2)\n    } else {\n      let currLevel = levels[player.level - 1]\n\n      if (!player.ended) {\n        player.part = { score: 0 }\n        player.loc = false\n        for (let i in player.poses) {\n          let noseScore = player.poses[i].pose.keypoints.find(key => key.part === 'nose')\n          if (noseScore.score > player.part.score) {\n            player.part = noseScore\n            player.loc = [player.part.position.x, player.part.position.y]\n          }\n        }\n\n        s.fill(0)\n        s.noStroke()\n        s.textSize(22)\n        s.textAlign(s.LEFT, s.TOP)\n        s.text(`Level ${player.level}`, 20, 5)\n\n        s.textAlign(s.RIGHT, s.TOP)\n        s.text(currLevel.obj, s.width / 4, 5, (3 * s.width) / 4)\n\n        s.textAlign(s.CENTER, s.BOTTOM)\n        s.textSize(18)\n        s.text('Move your head in real life to control the game', s.width / 2, s.height - 5)\n\n        s.imageMode(s.CENTER)\n        s.image(currLevel.img.loaded, currLevel.loc[0], currLevel.loc[1], currLevel.img.size[0], currLevel.img.size[0])\n\n        if (player.loc !== false) {\n          player.coords = [640 - player.loc[0], player.loc[1]]\n\n          player.distFrom = Math.hypot(player.coords[0] - currLevel.loc[0],\n            player.coords[1] - currLevel.loc[1])\n\n          if (player.distFrom <= currLevel.dist) {\n            if (player.debug) console.log('levelup')\n            player.snapped.push(videoInput.get())\n            player.level++\n            wakeupRemote()\n            if (player.level > levels.length) player.ended = true\n          }\n        }\n        if (player.coords !== false) {\n          s.image(currLevel.cursor.loaded, player.coords[0], player.coords[1],\n            currLevel.cursor.size[0], currLevel.cursor.size[1])\n        }\n      } else {\n        s.imageMode(s.CORNER)\n        for (let i in player.snapped) {\n          if (levels[i].side === 1) {\n            s.push()\n            s.translate(s.width / 2, 0)\n            s.scale(-1.0, 1.0)\n          }\n          s.image(player.snapped[i], 0, i * (s.height / 2), s.width / 2, s.height / 2)\n          if (levels[i].side === 1) s.pop()\n        }\n        for (let i in levels) {\n          if (levels[i].side === 0) {\n            s.push()\n            s.translate(s.width, 0)\n            s.scale(-1.0, 1.0)\n            s.image(levels[i].img.counter, 0, i * (s.height / 2), s.width / 2, s.height / 2)\n            s.pop()\n          } else {\n            s.image(levels[i].img.counter, s.width / 2, i * (s.height / 2), s.width / 2, s.height / 2)\n          }\n        }\n        s.stroke(0)\n        s.fill(255)\n        s.textSize(40)\n        s.textAlign(s.CENTER, s.CENTER)\n        s.text('Wow! very cute!', s.width / 2, s.height / 2)\n\n        s.textAlign(s.CENTER, s.BOTTOM)\n        s.textSize(18)\n        s.text('Click or press any key to play again!', s.width / 2, s.height - 5)\n\n        if (!player.sent) {\n          if (player.debug) console.log('sending')\n          let sendData = {\n            images: [],\n            created: new Date(),\n            userAgent: window.navigator.userAgent,\n            devicePixelRatio: window.devicePixelRatio\n          }\n          for (let i in player.snapped) {\n            sendData.images.push({\n              level: s.int(i) + 1,\n              img: player.snapped[i].canvas.toDataURL()\n            })\n          }\n          if (player.debug) console.log('sendData', sendData)\n\n          wakeupRemote()\n          let request = new XMLHttpRequest()\n          request.open('POST', 'https://face-game.glitch.me/api/0/submit', true)\n          request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8')\n          if (!player.debug) request.send(JSON.stringify(sendData))\n          player.sent = true\n        }\n      }\n    }\n  }\n\n  s.mousePressed = function mousePressed () {\n    if (player.debug) console.log('mousepress')\n    if (player.sent) init(player.cameraReady, player.modelReady, player.debug, () => {})\n  }\n  s.keyPressed = function keyPressed () {\n    if (player.debug) console.log('keypress')\n    if (player.sent) init(player.cameraReady, player.modelReady, player.debug, () => {})\n    else if (s.keyCode === 68 && !player.debug) {\n      console.log('debug mode')\n      player.debug = true\n    }\n  }\n}\nvar p5Runtime = new p5(sketch, 'p5sketch')\n"],"file":"sketch.js"}