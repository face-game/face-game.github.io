{"version":3,"sources":["js/sketch.js"],"names":["sketch","s","videoInput","poseNet","canvasBg","player","getContent","callback","request","XMLHttpRequest","open","onload","getContentOnload","status","lines","responseText","split","content","int","random","length","debug","console","log","onerror","getContentOnerror","err","send","wakeupRemote","wakeupOnload","data","JSON","parse","remoteAwake","wakeupOnerror","init","cameraReady","modelReady","ended","loc","coords","poses","part","level","snapped","sent","i","levels","img","loaded","loadImage","src","cursor","counter","obj","side","dist","size","setup","createCanvas","textSize","createCapture","video","mandatory","minWidth","minHeight","optional","minFrameRate","audio","hide","ml5","on","results","draw","imageMode","CORNERS","background","color","push","translate","width","scale","image","get","height","pop","textFont","textAlign","CENTER","text","currLevel","score","noseScore","pose","keypoints","find","key","position","x","y","fill","noStroke","LEFT","TOP","RIGHT","BOTTOM","distFrom","Math","hypot","CORNER","stroke","sendData","images","created","Date","userAgent","window","navigator","canvas","toDataURL","setRequestHeader","stringify","mousePressed","keyPressed","keyCode","p5Runtime","p5"],"mappings":"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","sourcesContent":["/* public/js/sketch.js\n * Originally created 9/29/2017 by Perry Naseck (DaAwesomeP)\n * https://github.com/face-game/face-game\n *\n * Copyright 2018-present Perry Naseck (DaAwesomeP)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* global p5, ml5, XMLHttpRequest */\n/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"p5Runtime| }] */\n/* eslint new-cap: [\"error\", { \"newIsCapExceptionPattern\": \"clm|p5\" }] */\n'use strict'\n\nvar sketch = function (s) {\n  var videoInput\n  var poseNet\n  var canvasBg\n\n  var player = {}\n  var getContent = function getContent (callback) {\n    let request = new XMLHttpRequest()\n    request.open('GET', 'https://face-game.github.io/face-game-content/content.txt', true)\n    request.onload = function getContentOnload () {\n      if (request.status >= 200 && request.status < 400) {\n        let lines = request.responseText.split('\\n')\n        player.content = lines[s.int(s.random(lines.length - 1))]\n        if (player.debug) console.log('content', player.content)\n        callback()\n      }\n    }\n    request.onerror = function getContentOnerror (err) {\n      console.log('getContentError', err)\n      player.content = false\n    }\n    request.send()\n  }\n  var wakeupRemote = function wakeupRemote () {\n    let request = new XMLHttpRequest()\n    request.open('GET', 'https://face-game.glitch.me/api/0/wakeup', true)\n    request.onload = function wakeupOnload () {\n      if (request.status >= 200 && request.status < 400) {\n        let data = JSON.parse(request.responseText)\n        if (data === { status: 200 }) player.remoteAwake = true\n        else player.remoteAwake = false\n        if (player.debug) console.log('wakeupRemote', data)\n      }\n    }\n    request.onerror = function wakeupOnerror (err) {\n      console.log('wakeupError', err)\n      player.remoteAwake = false\n    }\n    request.send()\n  }\n  var init = function init (cameraReady = false, modelReady = false, debug = false, callback) {\n    if (player.debug) console.log('init')\n    player = {\n      ended: false,\n      loc: false,\n      coords: false,\n      cameraReady: cameraReady,\n      modelReady: modelReady,\n      poses: [],\n      part: {},\n      level: 1,\n      snapped: [],\n      sent: false,\n      remoteAwake: false,\n      content: false,\n      debug: debug\n    }\n    wakeupRemote()\n    getContent(() => {\n      for (let i in levels) {\n        levels[i].img.loaded = s.loadImage(levels[i].img.src)\n        levels[i].cursor.loaded = s.loadImage(levels[i].cursor.src)\n        levels[i].img.counter = s.loadImage(`https://face-game.github.io/face-game-content/level-${s.int(i) + 1}/${player.content}.png`)\n      }\n      callback()\n    })\n  }\n  var levels = [\n    {\n      obj: 'Stick out your tongue, turn, and lick the lollipop',\n      loc: [65, 185],\n      side: 0,\n      dist: 40,\n      img: {\n        src: '/img/level-01.png',\n        size: [100, 100]\n      },\n      cursor: {\n        src: '/img/cursor-01.png',\n        size: [100, 100]\n      }\n    },\n    {\n      obj: 'Pucker your lips, turn, and kiss the puppy',\n      loc: [575, 260],\n      side: 1,\n      dist: 40,\n      img: {\n        src: '/img/level-02.png',\n        size: [100, 100]\n      },\n      cursor: {\n        src: '/img/cursor-02.png',\n        size: [100, 100]\n      }\n    }\n  ]\n\n  s.setup = function setup () {\n    init(false, false, false, () => {\n      canvasBg = s.loadImage('/img/45-degree-fabric-light.png')\n      s.createCanvas(640, 480)\n      s.textSize(50)\n\n      videoInput = s.createCapture({\n        video: {\n          mandatory: {\n            minWidth: 640,\n            minHeight: 480\n          },\n          optional: [{ minFrameRate: 10 }]\n        },\n        audio: false\n      }, () => {\n        player.cameraReady = true\n      })\n      videoInput.size(640, 480)\n      videoInput.hide()\n\n      poseNet = ml5.poseNet(videoInput, () => {\n        player.modelReady = true\n      })\n      poseNet.on('pose', (results) => {\n        player.poses = results\n      })\n    })\n  }\n\n  s.draw = function draw () {\n    s.imageMode(s.CORNERS)\n    s.background(s.color(252, 249, 213))\n    if (player.debug) {\n      s.push()\n      s.translate(s.width, 0)\n      s.scale(-1.0, 1.0)\n      s.image(videoInput.get(), 0, 0, s.width, s.height)\n      s.pop()\n    }\n    // s.background(canvasBg)\n    s.textFont('Gloria Hallelujah', 22)\n    if (!player.cameraReady) {\n      if (player.debug) console.log('not camera ready')\n      s.textAlign(s.CENTER, s.CENTER)\n      s.text('Your browser will prompt you to allow this website to access your camera. Please allow access to play the game.', s.width / 4, s.height / 4, s.width / 2, s.height / 2)\n    } else if (!player.modelReady) {\n      if (player.debug) console.log('show loading')\n      s.textAlign(s.CENTER, s.CENTER)\n      s.text('Loading face detection model...', s.width / 4, s.height / 4, s.width / 2, s.height / 2)\n    } else {\n      let currLevel = levels[player.level - 1]\n\n      if (!player.ended) {\n        player.part = { score: 0 }\n        player.loc = false\n        for (let i in player.poses) {\n          let noseScore = player.poses[i].pose.keypoints.find(key => key.part === 'nose')\n          if (noseScore.score > player.part.score) {\n            player.part = noseScore\n            player.loc = [player.part.position.x, player.part.position.y]\n          }\n        }\n\n        s.fill(0)\n        s.noStroke()\n        s.textSize(22)\n        s.textAlign(s.LEFT, s.TOP)\n        s.text(`Level ${player.level}`, 20, 5)\n\n        s.textAlign(s.RIGHT, s.TOP)\n        s.text(currLevel.obj, s.width / 4, 5, (3 * s.width) / 4)\n\n        s.textAlign(s.CENTER, s.BOTTOM)\n        s.textSize(18)\n        s.text('Move your head in real life to control the game', s.width / 2, s.height - 5)\n\n        s.imageMode(s.CENTER)\n        s.image(currLevel.img.loaded, currLevel.loc[0], currLevel.loc[1], currLevel.img.size[0], currLevel.img.size[0])\n\n        if (player.loc !== false) {\n          player.coords = [640 - player.loc[0], player.loc[1]]\n\n          player.distFrom = Math.hypot(player.coords[0] - currLevel.loc[0],\n            player.coords[1] - currLevel.loc[1])\n\n          if (player.distFrom <= currLevel.dist) {\n            if (player.debug) console.log('levelup')\n            player.snapped.push(videoInput.get())\n            player.level++\n            wakeupRemote()\n            if (player.level > levels.length) player.ended = true\n          }\n        }\n        if (player.coords !== false) {\n          s.image(currLevel.cursor.loaded, player.coords[0], player.coords[1],\n            currLevel.cursor.size[0], currLevel.cursor.size[1])\n        }\n      } else {\n        s.imageMode(s.CORNER)\n        for (let i in player.snapped) {\n          if (levels[i].side === 1) {\n            s.push()\n            s.translate(s.width / 2, 0)\n            s.scale(-1.0, 1.0)\n          }\n          s.image(player.snapped[i], 0, i * (s.height / 2), s.width / 2, s.height / 2)\n          if (levels[i].side === 1) s.pop()\n        }\n        for (let i in levels) {\n          if (levels[i].side === 0) {\n            s.push()\n            s.translate(s.width, 0)\n            s.scale(-1.0, 1.0)\n            s.image(levels[i].img.counter, 0, i * (s.height / 2), s.width / 2, s.height / 2)\n            s.pop()\n          } else {\n            s.image(levels[i].img.counter, s.width / 2, i * (s.height / 2), s.width / 2, s.height / 2)\n          }\n        }\n        s.stroke(0)\n        s.fill(255)\n        s.textSize(40)\n        s.textAlign(s.CENTER, s.CENTER)\n        s.text('Wow! very cute!', s.width / 2, s.height / 2)\n\n        s.textAlign(s.CENTER, s.BOTTOM)\n        s.textSize(18)\n        s.text('Click or press any key to play again!', s.width / 2, s.height - 5)\n\n        if (!player.sent) {\n          if (player.debug) console.log('sending')\n          let sendData = {\n            images: [],\n            created: new Date(),\n            userAgent: window.navigator.userAgent\n          }\n          for (let i in player.snapped) {\n            sendData.images.push({\n              level: s.int(i) + 1,\n              img: player.snapped[i].canvas.toDataURL()\n            })\n          }\n          if (player.debug) console.log('sendData', sendData)\n\n          wakeupRemote()\n          let request = new XMLHttpRequest()\n          request.open('POST', 'https://face-game.glitch.me/api/0/submit', true)\n          request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8')\n          if (!player.debug) request.send(JSON.stringify(sendData))\n          player.sent = true\n        }\n      }\n    }\n  }\n\n  s.mousePressed = function mousePressed () {\n    if (player.debug) console.log('mousepress')\n    if (player.sent) init(player.cameraReady, player.modelReady, player.debug, () => {})\n  }\n  s.keyPressed = function keyPressed () {\n    if (player.debug) console.log('keypress')\n    if (player.sent) init(player.cameraReady, player.modelReady, player.debug, () => {})\n    else if (s.keyCode === 68 && !player.debug) {\n      console.log('debug mode')\n      player.debug = true\n    }\n  }\n}\nvar p5Runtime = new p5(sketch, 'p5sketch')\n"],"file":"sketch.js"}